const spawnSync = require('child_process').spawn;
const async = require('async');
const fs = require('fs');

let optionsExecSync = {
    stdio: 'inherit',
    shell: true
};

let testPath = 'test/';
let tests = fs.readdirSync(testPath);

function testsStart() {
    async.mapSeries(tests,function(test,next) {
        if (!test.match(/^[0-9]/)) return next();
        test = testPath+test;
        let t = spawnSync('node',['node_modules/tap/bin/run.js','-b',test], optionsExecSync);
        t.on('close',() => {
            setTimeout(next,1000);
        });
    });
}

testsStart();